import * as Crypto from "crypto";
import { VerifyRSASign } from "./utils_rsa";

test("Verify RSA Sign", () => {
  let publicKey = `-----BEGIN PUBLIC KEY-----\r\nMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA2ys1SaOk+0ewDSssfCuL\r\nX0AdvRvcz2+VtrNMggF4VGxRcphB3DUL1HDWqal1yY4LfYN6v7rJ3J3kP24uhQB/\r\noonwXgaXTFcBODGIekKMsMtUFLgXeukMl6fb3wzFcPvJpIxeHyx1EizJdkEQTWBH\r\nA53s+KdeDCHgXhx/iyuu/2JoL91ziGtom9yy8Ll80AX/B5jBIGoXn1vvK9gcsw2S\r\n0mJdDSYgAOaH0loqzRJTW/AJkPKMXx+R5gTNrlJXN4kPRUPbSvK3tABEsC64xNiX\r\nrhuxTkH+GvCY+348O85XIWVWOP/CjhNyooZL4CaLYwo8Ic0ALu7hDr8CEp8Q9dYy\r\nQ23WsUVxhY1IuSg7/bwPBe/56cpxh3WUpY3dxOMPasdinGWneJ4ohZYjHQd7KAwC\r\n48EVEYDkhp46bkt9VzgQ2OX2YWfJL+9Et17UIWdss+5Yeql9I6uyi1RpsKgeR5w/\r\nhvivZhBS7/AzsvR0ejdcRaDsOtGuVYHOhlA0LpTzEpJuQdPdOf+TuefRB3LqO0Ki\r\nCr7gBHFFwlqy/tZ2zEucccx9clKAPH1MY3+R+yEDcJnzibYe68IFQS4fp4pv70Iw\r\niZFDtiGGFBilTQcbqW/vfQWqnI+4rsYEWEu4xN+AJpHvcRAXXD9lBta9+qnR+5fx\r\noBRT+o2UD8fKVs13QP+Sbq8CAwEAAQ==\r\n-----END PUBLIC KEY-----\r\n`;
  let sign = new Uint8Array([
    0, 158, 21, 112, 112, 161, 245, 41, 25, 16, 126, 115, 172, 105, 145, 120,
    36, 42, 46, 22, 43, 194, 74, 93, 53, 6, 184, 112, 32, 219, 11, 191, 137, 93,
    224, 11, 129, 61, 230, 7, 27, 192, 204, 49, 87, 65, 27, 20, 61, 97, 90, 13,
    208, 175, 187, 141, 58, 170, 47, 250, 96, 50, 78, 142, 146, 229, 125, 150,
    189, 240, 221, 12, 139, 153, 69, 159, 72, 180, 196, 51, 33, 79, 96, 117,
    134, 121, 158, 204, 2, 46, 201, 109, 81, 53, 154, 246, 18, 124, 178, 70,
    215, 107, 176, 13, 27, 108, 236, 220, 3, 183, 122, 47, 128, 81, 63, 36, 149,
    156, 172, 196, 195, 112, 29, 70, 8, 78, 129, 135, 78, 101, 246, 181, 89,
    117, 232, 219, 40, 54, 103, 101, 140, 173, 216, 1, 222, 140, 98, 223, 15,
    40, 145, 178, 183, 76, 20, 22, 175, 9, 199, 77, 124, 72, 119, 134, 8, 133,
    98, 187, 245, 255, 137, 40, 213, 156, 24, 81, 247, 233, 158, 123, 225, 133,
    207, 155, 88, 5, 209, 254, 133, 239, 191, 162, 195, 164, 208, 29, 23, 173,
    229, 151, 109, 173, 86, 51, 148, 105, 144, 255, 134, 183, 31, 66, 76, 180,
    128, 235, 195, 181, 14, 50, 243, 89, 252, 156, 95, 81, 217, 216, 130, 16,
    248, 78, 109, 11, 85, 255, 28, 23, 123, 74, 193, 248, 237, 9, 216, 190, 201,
    133, 231, 61, 206, 218, 87, 7, 52, 115, 93, 47, 165, 119, 220, 106, 147, 71,
    133, 177, 180, 201, 7, 189, 155, 130, 223, 96, 30, 200, 105, 231, 207, 204,
    72, 135, 54, 250, 217, 244, 63, 200, 228, 113, 143, 201, 203, 142, 170, 172,
    197, 35, 66, 101, 184, 72, 155, 53, 219, 47, 93, 25, 47, 11, 90, 216, 146,
    227, 244, 236, 188, 110, 250, 157, 105, 65, 73, 60, 36, 54, 94, 40, 152, 62,
    67, 111, 194, 161, 151, 36, 104, 101, 133, 219, 119, 14, 154, 63, 120, 114,
    152, 146, 255, 218, 0, 45, 95, 38, 216, 12, 197, 10, 161, 198, 252, 11, 165,
    198, 143, 89, 81, 59, 213, 160, 112, 42, 87, 44, 62, 68, 250, 217, 116, 69,
    248, 108, 93, 249, 96, 204, 250, 97, 38, 43, 12, 92, 136, 191, 248, 45, 187,
    17, 14, 54, 197, 191, 43, 192, 129, 115, 177, 23, 229, 186, 225, 250, 161,
    138, 18, 177, 169, 191, 255, 121, 4, 97, 154, 94, 54, 206, 225, 199, 164,
    23, 198, 110, 144, 51, 19, 168, 235, 222, 76, 246, 232, 66, 170, 145, 190,
    188, 160, 141, 230, 177, 99, 198, 71, 161, 4, 165, 2, 177, 125, 60, 58, 18,
    185, 204, 182, 105, 20, 205, 194, 174, 6, 234, 105, 216, 80, 180, 133, 111,
    24, 165, 2, 188, 156, 169, 237, 75, 93, 83, 174, 74, 49, 20, 174, 188, 168,
    112, 21, 255, 121, 17, 228, 155, 111, 41, 63, 138, 229, 255, 139, 195, 89,
    34,
  ]);

  let data = new Uint8Array([
    50, 56, 48, 53, 49, 56, 52, 50, 53, 57, 50, 49, 56, 56, 48, 48, 52, 52, 49,
    48, 56, 49, 51, 56, 53, 53, 55, 53, 51, 49, 52, 48, 50, 56, 55, 50, 55, 54,
    50, 49, 51, 48, 49, 50, 48, 57, 54, 48, 49, 57, 53, 50, 53, 57, 48, 51, 53,
    48, 53, 54, 53, 48, 56, 56, 52, 56, 52, 49, 50, 49, 49, 50, 49, 55, 49, 52,
    54, 57, 55, 48, 56, 49, 49, 51, 51, 55, 52, 51, 50, 49, 54, 53, 48, 49, 52,
    54, 50, 53, 57, 57, 56, 51, 53, 57, 52, 48, 49, 50, 53, 48, 52, 57, 49, 56,
    55, 51, 56, 49, 54, 57, 55, 56, 54, 50, 50, 51, 53, 55, 53, 52, 57, 54, 57,
    56, 51, 54, 55, 52, 50, 49, 53, 57, 57, 50, 57, 52, 56, 53, 53, 48, 55, 54,
    57, 49, 50, 50, 51, 57, 54, 57, 51, 50, 49, 57, 56, 52, 49, 53, 55, 51, 56,
    49, 53, 50, 50, 52, 55, 48, 54, 56, 53, 57, 52, 53, 56, 48, 57, 50, 49, 57,
    51, 56, 52, 56, 51, 53, 48, 57, 49, 54, 56, 51, 49, 54, 54, 53, 57, 55, 52,
    49, 56, 51, 56, 56, 53, 53, 54, 50, 55, 51, 51, 50, 52, 50, 55, 51, 51, 52,
    51, 54, 48, 54, 51, 50, 51, 56, 51, 55, 56, 50, 57, 52, 56, 52, 55, 49, 57,
    49, 57, 55, 57, 55, 53, 56, 48, 53, 55, 48, 54, 56, 54, 49, 57, 51, 54, 57,
    52, 54, 52, 53, 49, 56, 51, 51, 50, 55, 49, 50, 54, 56, 54, 56, 48, 53, 53,
    51, 52, 56, 51, 48, 48, 49, 49, 48, 50, 52, 50, 50, 50, 54, 54, 48, 49, 50,
    48, 51, 52, 48, 53, 49, 57, 53, 54, 51, 57, 57, 54, 53, 52, 51, 49, 51, 53,
    51, 56, 52, 53, 57, 53, 53, 54, 54, 48, 51, 57, 54, 51, 52, 57, 54, 56, 49,
    54, 48, 52, 56, 56, 50, 57, 50, 56, 55, 55, 51, 56, 50, 50, 56, 54, 53, 56,
    48, 50, 57, 52, 49, 48, 49, 48, 53, 54, 56, 50, 54, 48, 57, 57, 52, 49, 52,
    49, 51, 57, 53, 48, 48, 53, 54, 48, 48, 52, 55, 51, 52, 55, 53, 53, 55, 53,
    51, 51, 50, 49, 54, 56, 52, 50, 56, 55, 52, 54, 53, 51, 48, 54, 56, 50, 51,
    56, 54, 56, 50, 48, 55, 55, 56, 54, 56, 57, 49, 55, 48, 48, 56, 52, 51, 50,
    54, 54, 52, 50, 55, 52, 49, 57, 56, 55, 48, 57, 56, 48, 57, 48, 57, 52, 50,
    57, 57, 48, 57, 49,
  ]);

  let isVerify = VerifyRSASign(publicKey, data, sign);

  expect(isVerify).toBe(true);
});
